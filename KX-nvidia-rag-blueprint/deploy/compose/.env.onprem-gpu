# =============================================================================
# On-Premises GPU Cluster Environment Variables
# =============================================================================
# Copy this file to .env.onprem-gpu.local and fill in your credentials.
# Never commit .local files to version control.
#
# Usage:
#   cp .env.onprem-gpu .env.onprem-gpu.local
#   # Edit .env.onprem-gpu.local with your values
#   source .env.onprem-gpu.local
#   docker compose -f docker-compose-onprem-gpu.yaml up -d

# =============================================================================
# Required Credentials
# =============================================================================

# NVIDIA NGC API Key (required for pulling NIM images)
# Get from: https://ngc.nvidia.com
export NGC_API_KEY=""

# KDB.AI License (base64 encoded)
# Get from: https://kx.com
export KDB_LICENSE_B64=""

# KX Docker Registry Credentials
# Get from: KX welcome email
export KDBAI_REGISTRY_EMAIL=""
export KDBAI_REGISTRY_TOKEN=""

# =============================================================================
# GPU Assignment
# =============================================================================
# Assign GPUs to services. Adjust based on your GPU count and memory.
# Default assumes 6+ GPUs. For fewer GPUs, services can share.

# KDB.AI with cuVS (requires ~16GB VRAM)
export KDBAI_GPU_DEVICE_ID=0

# Embedding NIM (requires ~8GB VRAM)
export EMBEDDING_GPU_DEVICE_ID=1

# Reranker NIM (requires ~4GB VRAM, can share with embedding)
export RERANKER_GPU_DEVICE_ID=1

# NV-Ingest GPU NIMs
export PAGE_ELEMENTS_GPU_ID=2       # ~8GB VRAM
export GRAPHIC_ELEMENTS_GPU_ID=3    # ~8GB VRAM
export TABLE_STRUCTURE_GPU_ID=4     # ~8GB VRAM

# =============================================================================
# Service Configuration
# =============================================================================

# KDB.AI threads (adjust based on CPU cores)
export KDBAI_THREADS=8

# MinIO credentials (used by NV-Ingest and cloud cluster)
# Change these for production!
export MINIO_ACCESS_KEY="minioadmin"
export MINIO_SECRET_KEY="minioadmin"

# =============================================================================
# Network Configuration
# =============================================================================
# The IP address of this server (accessible from cloud via VPN)
# Used by cloud cluster to connect to on-prem services
export ONPREM_HOST_IP=""

# Example DNS entries to add to cloud cluster:
# ${ONPREM_HOST_IP}  kdbai.onprem.internal
# ${ONPREM_HOST_IP}  embedding-nim.onprem.internal
# ${ONPREM_HOST_IP}  reranker-nim.onprem.internal
# ${ONPREM_HOST_IP}  nv-ingest.onprem.internal
# ${ONPREM_HOST_IP}  minio.onprem.internal

# =============================================================================
# Docker Registry Login (run before docker compose up)
# =============================================================================
# Login to NGC registry
# echo "${NGC_API_KEY}" | docker login nvcr.io -u '$oauthtoken' --password-stdin

# Login to KX registry (for cuVS image)
# echo "${KDBAI_REGISTRY_TOKEN}" | docker login portal.dl.kx.com -u "${KDBAI_REGISTRY_EMAIL}" --password-stdin
# echo "${KDBAI_REGISTRY_TOKEN}" | docker login ext-dev-registry.kxi-dev.kx.com -u "${KDBAI_REGISTRY_EMAIL}" --password-stdin
